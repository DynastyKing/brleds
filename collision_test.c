#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "md6.h"

int debug;

int main(int argc, char* argv[]) {

  md6_word output1[16];
  md6_word output2[16];
  md6_word m1[89];
  md6_word m2[89];

  md6_word d1[] = {
0x0000000000000000, 0x6EF0359F901D87F1, 0x0B0E1A5E6321FACA,
0x17CC7114EA489DFB, 0xEE8C008EC83ADB73, 0x7DB8EEDCFA877E39,
0xE4F21D3F24A08F8D, 0x753BABD8D644EDB0, 0x4F3A19069D9912C5,
0x786CFC810173C666, 0x381C9EBA16E2A3C0, 0xA9EF65B15223A96F,
0x79125FE5ED6654F9, 0x256822D085A97E6F, 0xBE9E19C46A232D8F,
0x4F63FA40B5805A71, 0x149E18A2553C89D9, 0xC47A2B80778A13B4,
0x448615232679EE76, 0x7AD4789C97E5F3E6, 0xD881854B48DFFDEA,
0x3D4E31C0D7F536F3, 0xA81CCE887C5966BA, 0xE84CE67C944937B0,
0xE0BC49CA9221F55B, 0x626CE75D7F3426E6, 0x12DDF6BE3A9A5764,
0xA19B63F8F336EC09, 0x0BE1611345DA86B6, 0xD9B0DDBF7A9CB231,
0xF6DDE43FDA51A699, 0xEF486A8ED933B8D6, 0xDEC9BF12276F4078,
0xA8F7B8932898C367, 0x630AC37CB01B0B26, 0x92042C7571E17A51,
0x3E044C8B2D51E96C, 0x12F1062AB201F3AE, 0x0000000000000000,
0xFD1E657756AFC231, 0xFE6E1C74C69A8F86, 0x4FF44422E909B260,
0x5EDF8E2C5D33021F, 0x2B80683DD9463E5D, 0x5EFC13E095C16ADD,
0x3182E95DDE4E3095, 0x1B52BDDBB8D180DD, 0x74F4DB9BF1934EA4,
0xB95A6C3000D51C65, 0x717109F224B5893D, 0x7B060EFD27386992,
0x2FACB0F1278BC1B0, 0x0F8BEF7245064CD9, 0x21321CFB83CC5F37,
0x6986B11D48A366A5, 0x0000000000000000, 0xB515C7D5319A32CE,
0x030DA13B590361ED, 0xB6B12C22B1079BA4, 0x4961D5A72B31C1CD,
0xD2282CA488330A45, 0xDD66996C3C01F057, 0x9F97EE02E405EF8B,
0xCB5E9F15AE056CFA};

  md6_word diff[] = {0, 0, 0xF6D164597089C40E, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x2000000000000000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

  md6_word A1[345];
  md6_word A2[345];

  int i;

  debug = 2;

  memset(m1, 0x0, sizeof(md6_word)*89);
  memset(m2, 0x0, sizeof(md6_word)*89);
  memset(A1, 0x0, sizeof(md6_word)*345);
  memset(A2, 0x0, sizeof(md6_word)*345);

  memcpy(m1, &Q, md6_q*sizeof(md6_word));
  memcpy(m2, &Q, md6_q*sizeof(md6_word));

  memcpy(&(m1[25]), d1, sizeof(md6_word)*64);
  memcpy(&(m2[25]), d1, sizeof(md6_word)*64);

  for (i=25; i < 89; i++) {
    m2[i] ^= diff[i-25];
  }

  memcpy(A1, m1, 89*sizeof(md6_word));
  memcpy(A2, m2, 89*sizeof(md6_word));

  md6_main_compression_loop(A1, 16);
  md6_main_compression_loop(A2, 16);

  print_buf(A1, 345);
  print_buf(A2, 345);

}
